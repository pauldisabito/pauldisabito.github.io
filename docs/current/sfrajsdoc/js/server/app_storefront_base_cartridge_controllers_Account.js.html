<!DOCTYPE html>
<html lang="en">
<head>
    <script type="text/javascript">
        WebFontConfig = {
            google: { families: [ 'Open+Sans::latin' ] }
        };
        (function() {
        var wf = document.createElement('script');
        wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
            '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
        wf.type = 'text/javascript';
        wf.async = 'true';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(wf, s);
        })();
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SFRA Server-side Javascript - Source: app_storefront_base/cartridge/controllers/Account.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/demandware-jsdoc.css">
</head>

<body>

<svg display="none" width="0" height="0" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs>
<symbol id="icon-menu" viewBox="0 0 1024 1024">
    <title>menu</title>
    <path class="path1" d="M64 192h896v192h-896zM64 448h896v192h-896zM64 704h896v192h-896z"></path>
</symbol>
</defs>
</svg>

<input type="checkbox" id="nav-trigger" class="nav-trigger menu-icon" />
<label for="nav-trigger"><svg class="icon icon-menu"><use xlink:href="#icon-menu"></use></svg></label>

<div id="main">

    <h2 class="page-title">
        <a href="../../index.html">SFRA</a> /
        <a href="index.html">Server-side JS</a> /
        Source: app_storefront_base/cartridge/controllers/Account.js
    </h2>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

/**
 * @namespace Account
 */

var server = require('server');

var csrfProtection = require('*/cartridge/scripts/middleware/csrf');
var userLoggedIn = require('*/cartridge/scripts/middleware/userLoggedIn');
var consentTracking = require('*/cartridge/scripts/middleware/consentTracking');

/**
 * Checks if the email value entered is correct format
 * @param {string} email - email string to check if valid
 * @returns {boolean} Whether email is valid
 */
function validateEmail(email) {
    var regex = /^[\w.%+-]+@[\w.-]+\.[\w]{2,6}$/;
    return regex.test(email);
}

/**
 * Account-Show : The Account-Show endpoint will render the shopper's account page. Once a shopper logs in they will see is a dashboard that displays profile, address, payment and order information.
 * @name Base/Account-Show
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {middleware} - userLoggedIn.validateLoggedIn
 * @param {middleware} - consentTracking.consent
 * @param {querystringparameter} - registration - A flag determining whether or not this is a newly registered account
 * @param {category} - senstive
 * @param {renders} - isml
 * @param {serverfunction} - get
 */
server.get(
    'Show',
    server.middleware.https,
    userLoggedIn.validateLoggedIn,
    consentTracking.consent,
    function (req, res, next) {
        var CustomerMgr = require('dw/customer/CustomerMgr');
        var Resource = require('dw/web/Resource');
        var URLUtils = require('dw/web/URLUtils');
        var accountHelpers = require('*/cartridge/scripts/account/accountHelpers');
        var reportingUrlsHelper = require('*/cartridge/scripts/reportingUrls');
        var reportingURLs;

        // Get reporting event Account Open url
        if (req.querystring.registration &amp;&amp; req.querystring.registration === 'submitted') {
            reportingURLs = reportingUrlsHelper.getAccountOpenReportingURLs(
                CustomerMgr.registeredCustomerCount
            );
        }

        var accountModel = accountHelpers.getAccountModel(req);

        res.render('account/accountDashboard', {
            account: accountModel,
            accountlanding: true,
            breadcrumbs: [
                {
                    htmlValue: Resource.msg('global.home', 'common', null),
                    url: URLUtils.home().toString()
                }
            ],
            reportingURLs: reportingURLs
        });
        next();
    }
);

/**
 * Account-Login : The Account-Login endpoint will render the shopper's account page. Once a shopper logs in they will see is a dashboard that displays profile, address, payment and order information.
 * @name Base/Account-Login
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {middleware} - csrfProtection.validateAjaxRequest
 * @param {querystringparameter} - rurl - redirect url. The value of this is a number. This number then gets mapped to an endpoint set up in oAuthRenentryRedirectEndpoints.js
 * @param {httpparameter} - loginEmail - The email associated with the shopper's account.
 * @param {httpparameter} - loginPassword - The shopper's password
 * @param {httpparameter} - loginRememberMe - Whether or not the customer has decided to utilize the remember me feature.
 * @param {httpparameter} - csrf_token - a CSRF token
 * @param {category} - sensitive
 * @param {returns} - json
 * @param {serverfunction} - post
 *
 */
server.post(
    'Login',
    server.middleware.https,
    csrfProtection.validateAjaxRequest,
    function (req, res, next) {
        var CustomerMgr = require('dw/customer/CustomerMgr');
        var Resource = require('dw/web/Resource');
        var Site = require('dw/system/Site');
        var Transaction = require('dw/system/Transaction');

        var accountHelpers = require('*/cartridge/scripts/helpers/accountHelpers');
        var emailHelpers = require('*/cartridge/scripts/helpers/emailHelpers');
        var hooksHelper = require('*/cartridge/scripts/helpers/hooks');

        var email = req.form.loginEmail;
        var password = req.form.loginPassword;
        var rememberMe = req.form.loginRememberMe
            ? (!!req.form.loginRememberMe)
            : false;

        var customerLoginResult = Transaction.wrap(function () {
            var authenticateCustomerResult = CustomerMgr.authenticateCustomer(email, password);

            if (authenticateCustomerResult.status !== 'AUTH_OK') {
                var errorCodes = {
                    ERROR_CUSTOMER_DISABLED: 'error.message.account.disabled',
                    ERROR_CUSTOMER_LOCKED: 'error.message.account.locked',
                    ERROR_CUSTOMER_NOT_FOUND: 'error.message.login.form',
                    ERROR_PASSWORD_EXPIRED: 'error.message.password.expired',
                    ERROR_PASSWORD_MISMATCH: 'error.message.password.mismatch',
                    ERROR_UNKNOWN: 'error.message.error.unknown',
                    default: 'error.message.login.form'
                };

                var errorMessageKey = errorCodes[authenticateCustomerResult.status] || errorCodes.default;
                var errorMessage = Resource.msg(errorMessageKey, 'login', null);

                return {
                    error: true,
                    errorMessage: errorMessage,
                    status: authenticateCustomerResult.status,
                    authenticatedCustomer: null
                };
            }

            return {
                error: false,
                errorMessage: null,
                status: authenticateCustomerResult.status,
                authenticatedCustomer: CustomerMgr.loginCustomer(authenticateCustomerResult, rememberMe)
            };
        });

        if (customerLoginResult.error) {
            if (customerLoginResult.status === 'ERROR_CUSTOMER_LOCKED') {
                var context = {
                    customer: CustomerMgr.getCustomerByLogin(email) || null
                };

                var emailObj = {
                    to: email,
                    subject: Resource.msg('subject.account.locked.email', 'login', null),
                    from: Site.current.getCustomPreferenceValue('customerServiceEmail') || 'no-reply@testorganization.com',
                    type: emailHelpers.emailTypes.accountLocked
                };

                hooksHelper('app.customer.email', 'sendEmail', [emailObj, 'account/accountLockedEmail', context], function () {});
            }

            res.json({
                error: [customerLoginResult.errorMessage || Resource.msg('error.message.login.form', 'login', null)]
            });

            return next();
        }

        if (customerLoginResult.authenticatedCustomer) {
            res.setViewData({ authenticatedCustomer: customerLoginResult.authenticatedCustomer });
            res.json({
                success: true,
                redirectUrl: accountHelpers.getLoginRedirectURL(req.querystring.rurl, req.session.privacyCache, false)
            });

            req.session.privacyCache.set('args', null);
        } else {
            res.json({ error: [Resource.msg('error.message.login.form', 'login', null)] });
        }

        return next();
    }
);

/**
 * Account-SubmitRegistration : The Account-SubmitRegistration endpoint is the endpoint that gets hit when a shopper submits their registration for a new account
 * @name Base/Account-SubmitRegistration
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {middleware} - csrfProtection.validateAjaxRequest
 * @param {querystringparameter} - rurl - redirect url. The value of this is a number. This number then gets mapped to an endpoint set up in oAuthRenentryRedirectEndpoints.js
 * @param {httpparameter} - dwfrm_profile_customer_firstname - Input field for the shoppers's first name
 * @param {httpparameter} - dwfrm_profile_customer_lastname - Input field for the shopper's last name
 * @param {httpparameter} - dwfrm_profile_customer_phone - Input field for the shopper's phone number
 * @param {httpparameter} - dwfrm_profile_customer_email - Input field for the shopper's email address
 * @param {httpparameter} - dwfrm_profile_customer_emailconfirm - Input field for the shopper's email address
 * @param {httpparameter} - dwfrm_profile_login_password - Input field for the shopper's password
 * @param {httpparameter} - dwfrm_profile_login_passwordconfirm: - Input field for the shopper's password to confirm
 * @param {httpparameter} - dwfrm_profile_customer_addtoemaillist - Checkbox for whether or not a shopper wants to be added to the mailing list
 * @param {httpparameter} - csrf_token - hidden input field CSRF token
 * @param {category} - sensitive
 * @param {returns} - json
 * @param {serverfunction} - post
 */
server.post(
    'SubmitRegistration',
    server.middleware.https,
    csrfProtection.validateAjaxRequest,
    function (req, res, next) {
        var CustomerMgr = require('dw/customer/CustomerMgr');
        var Resource = require('dw/web/Resource');

        var formErrors = require('*/cartridge/scripts/formErrors');

        var registrationForm = server.forms.getForm('profile');

        // form validation
        if (registrationForm.customer.email.value.toLowerCase()
            !== registrationForm.customer.emailconfirm.value.toLowerCase()
        ) {
            registrationForm.customer.email.valid = false;
            registrationForm.customer.emailconfirm.valid = false;
            registrationForm.customer.emailconfirm.error =
                Resource.msg('error.message.mismatch.email', 'forms', null);
            registrationForm.valid = false;
        }

        if (registrationForm.login.password.value
            !== registrationForm.login.passwordconfirm.value
        ) {
            registrationForm.login.password.valid = false;
            registrationForm.login.passwordconfirm.valid = false;
            registrationForm.login.passwordconfirm.error =
                Resource.msg('error.message.mismatch.password', 'forms', null);
            registrationForm.valid = false;
        }

        if (!CustomerMgr.isAcceptablePassword(registrationForm.login.password.value)) {
            registrationForm.login.password.valid = false;
            registrationForm.login.passwordconfirm.valid = false;
            registrationForm.login.passwordconfirm.error =
                Resource.msg('error.message.password.constraints.not.matched', 'forms', null);
            registrationForm.valid = false;
        }

        // setting variables for the BeforeComplete function
        var registrationFormObj = {
            firstName: registrationForm.customer.firstname.value,
            lastName: registrationForm.customer.lastname.value,
            phone: registrationForm.customer.phone.value,
            email: registrationForm.customer.email.value,
            emailConfirm: registrationForm.customer.emailconfirm.value,
            password: registrationForm.login.password.value,
            passwordConfirm: registrationForm.login.passwordconfirm.value,
            validForm: registrationForm.valid,
            form: registrationForm
        };

        if (registrationForm.valid) {
            res.setViewData(registrationFormObj);

            this.on('route:BeforeComplete', function (req, res) { // eslint-disable-line no-shadow
                var Transaction = require('dw/system/Transaction');
                var accountHelpers = require('*/cartridge/scripts/helpers/accountHelpers');
                var authenticatedCustomer;
                var serverError;

                // getting variables for the BeforeComplete function
                var registrationForm = res.getViewData(); // eslint-disable-line

                if (registrationForm.validForm) {
                    var login = registrationForm.email;
                    var password = registrationForm.password;

                    // attempt to create a new user and log that user in.
                    try {
                        Transaction.wrap(function () {
                            var error = {};
                            var newCustomer = CustomerMgr.createCustomer(login, password);

                            var authenticateCustomerResult = CustomerMgr.authenticateCustomer(login, password);
                            if (authenticateCustomerResult.status !== 'AUTH_OK') {
                                error = { authError: true, status: authenticateCustomerResult.status };
                                throw error;
                            }

                            authenticatedCustomer = CustomerMgr.loginCustomer(authenticateCustomerResult, false);

                            if (!authenticatedCustomer) {
                                error = { authError: true, status: authenticateCustomerResult.status };
                                throw error;
                            } else {
                                // assign values to the profile
                                var newCustomerProfile = newCustomer.getProfile();

                                newCustomerProfile.firstName = registrationForm.firstName;
                                newCustomerProfile.lastName = registrationForm.lastName;
                                newCustomerProfile.phoneHome = registrationForm.phone;
                                newCustomerProfile.email = registrationForm.email;
                            }
                        });
                    } catch (e) {
                        if (e.authError) {
                            serverError = true;
                        } else {
                            registrationForm.validForm = false;
                            registrationForm.form.customer.email.valid = false;
                            registrationForm.form.customer.emailconfirm.valid = false;
                            registrationForm.form.customer.email.error =
                                Resource.msg('error.message.username.invalid', 'forms', null);
                        }
                    }
                }

                delete registrationForm.password;
                delete registrationForm.passwordConfirm;
                formErrors.removeFormValues(registrationForm.form);

                if (serverError) {
                    res.setStatusCode(500);
                    res.json({
                        success: false,
                        errorMessage: Resource.msg('error.message.unable.to.create.account', 'login', null)
                    });

                    return;
                }

                if (registrationForm.validForm) {
                    // send a registration email
                    accountHelpers.sendCreateAccountEmail(authenticatedCustomer.profile);

                    res.setViewData({ authenticatedCustomer: authenticatedCustomer });
                    res.json({
                        success: true,
                        redirectUrl: accountHelpers.getLoginRedirectURL(req.querystring.rurl, req.session.privacyCache, true)
                    });

                    req.session.privacyCache.set('args', null);
                } else {
                    res.json({
                        fields: formErrors.getFormErrors(registrationForm)
                    });
                }
            });
        } else {
            res.json({
                fields: formErrors.getFormErrors(registrationForm)
            });
        }

        return next();
    }
);

/**
 * Account-EditProfile : The Account-EditProfile endpoint renders the page that allows a shopper to edit their profile. The edit profile form is prefilled with the shopper's first name, last name, phone number and email
 * @name Base/Account-EditProfile
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {middleware} - csrfProtection.generateToken
 * @param {middleware} - userLoggedIn.validateLoggedIn
 * @param {middleware} - consentTracking.consent
 * @param {category} - sensitive
 * @param {renders} - isml
 * @param {serverfunction} - get
 */
server.get(
    'EditProfile',
    server.middleware.https,
    csrfProtection.generateToken,
    userLoggedIn.validateLoggedIn,
    consentTracking.consent,
    function (req, res, next) {
        var Resource = require('dw/web/Resource');
        var URLUtils = require('dw/web/URLUtils');
        var accountHelpers = require('*/cartridge/scripts/account/accountHelpers');

        var accountModel = accountHelpers.getAccountModel(req);
        var profileForm = server.forms.getForm('profile');
        profileForm.clear();
        profileForm.customer.firstname.value = accountModel.profile.firstName;
        profileForm.customer.lastname.value = accountModel.profile.lastName;
        profileForm.customer.phone.value = accountModel.profile.phone;
        profileForm.customer.email.value = accountModel.profile.email;
        res.render('account/profile', {
            profileForm: profileForm,
            breadcrumbs: [
                {
                    htmlValue: Resource.msg('global.home', 'common', null),
                    url: URLUtils.home().toString()
                },
                {
                    htmlValue: Resource.msg('page.title.myaccount', 'account', null),
                    url: URLUtils.url('Account-Show').toString()
                }
            ]
        });
        next();
    }
);

/**
 * Account-SaveProfile : The Account-SaveProfile endpoint is the endpoint that gets hit when a shopper has edited their profile
 * @name Base/Account-SaveProfile
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {middleware} - csrfProtection.validateAjaxRequest
 * @param {httpparameter} - dwfrm_profile_customer_firstname - Input field for the shoppers's first name
 * @param {httpparameter} - dwfrm_profile_customer_lastname - Input field for the shopper's last name
 * @param {httpparameter} - dwfrm_profile_customer_phone - Input field for the shopper's phone number
 * @param {httpparameter} - dwfrm_profile_customer_email - Input field for the shopper's email address
 * @param {httpparameter} - dwfrm_profile_customer_emailconfirm - Input field for the shopper's email address
 * @param {httpparameter} - dwfrm_profile_login_password  - Input field for the shopper's password
 * @param {httpparameter} - csrf_token - hidden input field CSRF token
 * @param {category} - sensititve
 * @param {returns} - json
 * @param {serverfunction} - post
 */
server.post(
    'SaveProfile',
    server.middleware.https,
    csrfProtection.validateAjaxRequest,
    function (req, res, next) {
        var Transaction = require('dw/system/Transaction');
        var CustomerMgr = require('dw/customer/CustomerMgr');
        var Resource = require('dw/web/Resource');
        var URLUtils = require('dw/web/URLUtils');
        var accountHelpers = require('*/cartridge/scripts/helpers/accountHelpers');

        var formErrors = require('*/cartridge/scripts/formErrors');

        var profileForm = server.forms.getForm('profile');

        // form validation
        if (profileForm.customer.email.value.toLowerCase()
            !== profileForm.customer.emailconfirm.value.toLowerCase()) {
            profileForm.valid = false;
            profileForm.customer.email.valid = false;
            profileForm.customer.emailconfirm.valid = false;
            profileForm.customer.emailconfirm.error =
                Resource.msg('error.message.mismatch.email', 'forms', null);
        }

        var result = {
            firstName: profileForm.customer.firstname.value,
            lastName: profileForm.customer.lastname.value,
            phone: profileForm.customer.phone.value,
            email: profileForm.customer.email.value,
            confirmEmail: profileForm.customer.emailconfirm.value,
            password: profileForm.login.password.value,
            profileForm: profileForm
        };
        if (profileForm.valid) {
            res.setViewData(result);
            this.on('route:BeforeComplete', function (req, res) { // eslint-disable-line no-shadow
                var formInfo = res.getViewData();
                var customer = CustomerMgr.getCustomerByCustomerNumber(
                    req.currentCustomer.profile.customerNo
                );
                var profile = customer.getProfile();
                var customerLogin;
                var status;

                Transaction.wrap(function () {
                    status = profile.credentials.setPassword(
                        formInfo.password,
                        formInfo.password,
                        true
                    );

                    if (status.error) {
                        formInfo.profileForm.login.password.valid = false;
                        formInfo.profileForm.login.password.error =
                            Resource.msg('error.message.currentpasswordnomatch', 'forms', null);
                    } else {
                        customerLogin = profile.credentials.setLogin(
                            formInfo.email,
                            formInfo.password
                        );
                    }
                });

                delete formInfo.password;
                delete formInfo.confirmEmail;

                if (customerLogin) {
                    Transaction.wrap(function () {
                        profile.setFirstName(formInfo.firstName);
                        profile.setLastName(formInfo.lastName);
                        profile.setEmail(formInfo.email);
                        profile.setPhoneHome(formInfo.phone);
                    });

                    // Send account edited email
                    accountHelpers.sendAccountEditedEmail(customer.profile);

                    delete formInfo.profileForm;
                    delete formInfo.email;

                    res.json({
                        success: true,
                        redirectUrl: URLUtils.url('Account-Show').toString()
                    });
                } else {
                    if (!status.error) {
                        formInfo.profileForm.customer.email.valid = false;
                        formInfo.profileForm.customer.email.error =
                            Resource.msg('error.message.username.invalid', 'forms', null);
                    }

                    delete formInfo.profileForm;
                    delete formInfo.email;

                    res.json({
                        success: false,
                        fields: formErrors.getFormErrors(profileForm)
                    });
                }
            });
        } else {
            res.json({
                success: false,
                fields: formErrors.getFormErrors(profileForm)
            });
        }
        return next();
    }
);

/**
 * Account-EditPassword : The Account-EditPassword endpoint renders thes edit password pages. This page allows the shopper to change their password for their account
 * @name Base/Account-EditPassword
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {middleware} - csrfProtection.generateToken
 * @param {middleware} - userLoggedIn.validateLoggedIn
 * @param {middleware} - consentTracking.consent
 * @param {category} - sensitive
 * @param {renders} - isml
 * @param {serverfunction} - get
 */
server.get(
    'EditPassword',
    server.middleware.https,
    csrfProtection.generateToken,
    userLoggedIn.validateLoggedIn,
    consentTracking.consent,
    function (req, res, next) {
        var Resource = require('dw/web/Resource');
        var URLUtils = require('dw/web/URLUtils');

        var profileForm = server.forms.getForm('profile');
        profileForm.clear();
        res.render('account/password', {
            profileForm: profileForm,
            breadcrumbs: [
                {
                    htmlValue: Resource.msg('global.home', 'common', null),
                    url: URLUtils.home().toString()
                },
                {
                    htmlValue: Resource.msg('page.title.myaccount', 'account', null),
                    url: URLUtils.url('Account-Show').toString()
                }
            ]
        });
        next();
    }
);

/**
 * Account-SavePassword : The Account-SavePassword endpoint is the endpoit that handles changing the shopper's password
 * @name Base/Account-SavePassword
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {middleware} - csrfProtection.validateAjaxRequest
 * @param {httpparameter} - dwfrm_profile_login_currentpassword - Input field for the shopper's current password
 * @param {httpparameter} - dwfrm_profile_login_newpasswords_newpassword - Input field for the shopper's new password
 * @param {httpparameter} - dwfrm_profile_login_newpasswords_newpasswordconfirm - Input field for the shopper to confirm their new password
 * @param {httpparameter} - csrf_token - hidden input field CSRF token
 * @param {category} - sensitive
 * @param {returns} - json
 * @param {serverfunction} - post
 */
server.post(
    'SavePassword',
    server.middleware.https,
    csrfProtection.validateAjaxRequest,
    function (req, res, next) {
        var Transaction = require('dw/system/Transaction');
        var CustomerMgr = require('dw/customer/CustomerMgr');
        var Resource = require('dw/web/Resource');
        var URLUtils = require('dw/web/URLUtils');

        var formErrors = require('*/cartridge/scripts/formErrors');

        var profileForm = server.forms.getForm('profile');
        var newPasswords = profileForm.login.newpasswords;
        // form validation
        if (newPasswords.newpassword.value !== newPasswords.newpasswordconfirm.value) {
            profileForm.valid = false;
            newPasswords.newpassword.valid = false;
            newPasswords.newpasswordconfirm.valid = false;
            newPasswords.newpasswordconfirm.error =
                Resource.msg('error.message.mismatch.newpassword', 'forms', null);
        }

        var result = {
            currentPassword: profileForm.login.currentpassword.value,
            newPassword: newPasswords.newpassword.value,
            newPasswordConfirm: newPasswords.newpasswordconfirm.value,
            profileForm: profileForm
        };

        if (profileForm.valid) {
            res.setViewData(result);
            this.on('route:BeforeComplete', function () { // eslint-disable-line no-shadow
                var formInfo = res.getViewData();
                var customer = CustomerMgr.getCustomerByCustomerNumber(
                    req.currentCustomer.profile.customerNo
                );
                var status;
                Transaction.wrap(function () {
                    status = customer.profile.credentials.setPassword(
                        formInfo.newPassword,
                        formInfo.currentPassword,
                        true
                    );
                });
                if (status.error) {
                    if (!CustomerMgr.isAcceptablePassword(newPasswords.newpassword.value)) {
                        formInfo.profileForm.login.newpasswords.newpassword.valid = false;
                        formInfo.profileForm.login.newpasswords.newpassword.error =
                            Resource.msg('error.message.password.constraints.not.matched', 'forms', null);
                    } else {
                        formInfo.profileForm.login.currentpassword.valid = false;
                        formInfo.profileForm.login.currentpassword.error =
                            Resource.msg('error.message.currentpasswordnomatch', 'forms', null);
                    }

                    delete formInfo.currentPassword;
                    delete formInfo.newPassword;
                    delete formInfo.newPasswordConfirm;
                    delete formInfo.profileForm;

                    res.json({
                        success: false,
                        fields: formErrors.getFormErrors(profileForm)
                    });
                } else {
                    delete formInfo.currentPassword;
                    delete formInfo.newPassword;
                    delete formInfo.newPasswordConfirm;
                    delete formInfo.profileForm;

                    res.json({
                        success: true,
                        redirectUrl: URLUtils.url('Account-Show').toString()
                    });
                }
            });
        } else {
            res.json({
                success: false,
                fields: formErrors.getFormErrors(profileForm)
            });
        }
        return next();
    }
);

/**
 * Account-PasswordResetDialogForm : The Account-PasswordResetDialogForm endpoint is the endpoint that gets hit once the shopper has clicked forgot password and has submitted their email address to request to reset their password
 * @name Base/Account-PasswordResetDialogForm
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {querystringparameter} - mobile - a flag determining whether or not the shopper is on a mobile sized screen
 * @param {httpparameter} - loginEmail - Input field, the shopper's email address
 * @param {category} - sensitive
 * @param {returns} - json
 * @param {serverfunction} - post
 */
server.post('PasswordResetDialogForm', server.middleware.https, function (req, res, next) {
    var CustomerMgr = require('dw/customer/CustomerMgr');
    var Resource = require('dw/web/Resource');
    var URLUtils = require('dw/web/URLUtils');
    var accountHelpers = require('*/cartridge/scripts/helpers/accountHelpers');

    var email = req.form.loginEmail;
    var errorMsg;
    var isValid;
    var resettingCustomer;
    var mobile = req.querystring.mobile;
    var receivedMsgHeading = Resource.msg('label.resetpasswordreceived', 'login', null);
    var receivedMsgBody = Resource.msg('msg.requestedpasswordreset', 'login', null);
    var buttonText = Resource.msg('button.text.loginform', 'login', null);
    var returnUrl = URLUtils.url('Login-Show').toString();
    if (email) {
        isValid = validateEmail(email);
        if (isValid) {
            resettingCustomer = CustomerMgr.getCustomerByLogin(email);
            if (resettingCustomer) {
                accountHelpers.sendPasswordResetEmail(email, resettingCustomer);
            }
            res.json({
                success: true,
                receivedMsgHeading: receivedMsgHeading,
                receivedMsgBody: receivedMsgBody,
                buttonText: buttonText,
                mobile: mobile,
                returnUrl: returnUrl
            });
        } else {
            errorMsg = Resource.msg('error.message.passwordreset', 'login', null);
            res.json({
                fields: {
                    loginEmail: errorMsg
                }
            });
        }
    } else {
        errorMsg = Resource.msg('error.message.required', 'login', null);
        res.json({
            fields: {
                loginEmail: errorMsg
            }
        });
    }
    next();
});

/**
 * Account-PasswordReset : The Account-PasswordReset endpoint renders the forgot your password form that allows a shopper to submit their email address in order to request a password change
 * @name Base/Account-PasswordReset
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {category} - sensitive
 * @param {renders} - isml
 * @param {serverfunction} - get
 */
server.get('PasswordReset', server.middleware.https, function (req, res, next) {
    res.render('account/password/requestPasswordReset', { mobile: true });
    next();
});

/**
 * Account-SetNewPassword : The Account-SetNewPassword endpoint renders the page that displays the password reset form
 * @name Base/Account-SetNewPassword
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {middleware} - consentTracking.consent
 * @param {querystringparameter} - Token - SFRA utilizes this token to retrieve the shopper
 * @param {category} - sensitive
 * @param {renders} - isml
 * @param {serverfunction} - get
 */
server.get('SetNewPassword', server.middleware.https, consentTracking.consent, function (req, res, next) {
    var CustomerMgr = require('dw/customer/CustomerMgr');
    var URLUtils = require('dw/web/URLUtils');

    var passwordForm = server.forms.getForm('newPasswords');
    passwordForm.clear();
    var token = req.querystring.Token;
    var resettingCustomer = CustomerMgr.getCustomerByToken(token);
    if (!resettingCustomer) {
        res.redirect(URLUtils.url('Account-PasswordReset'));
    } else {
        res.render('account/password/newPassword', { passwordForm: passwordForm, token: token });
    }
    next();
});

/**
 * Account-SaveNewPassword : The Account-SaveNewPassword endpoint handles resetting a shoppers password. This is the last step in the forgot password user flow. (This step does not log the shopper in.)
 * @name Base/Account-SaveNewPassword
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.https
 * @param {querystringparameter} - Token - SFRA utilizes this token to retrieve the shopper
 * @param {httpparameter} - dwfrm_newPasswords_newpassword - Input field for the shopper's new password
 * @param {httpparameter} - dwfrm_newPasswords_newpasswordconfirm  - Input field to confirm the shopper's new password
 * @param {httpparameter} - save - unutilized param
 * @param {category} - sensitive
 * @param {renders} - isml
 * @param {serverfunction} - post
 */
server.post('SaveNewPassword', server.middleware.https, function (req, res, next) {
    var Transaction = require('dw/system/Transaction');
    var Resource = require('dw/web/Resource');

    var passwordForm = server.forms.getForm('newPasswords');
    var token = req.querystring.Token;

    if (passwordForm.newpassword.value !== passwordForm.newpasswordconfirm.value) {
        passwordForm.valid = false;
        passwordForm.newpassword.valid = false;
        passwordForm.newpasswordconfirm.valid = false;
        passwordForm.newpasswordconfirm.error =
            Resource.msg('error.message.mismatch.newpassword', 'forms', null);
    }

    if (passwordForm.valid) {
        var result = {
            newPassword: passwordForm.newpassword.value,
            newPasswordConfirm: passwordForm.newpasswordconfirm.value,
            token: token,
            passwordForm: passwordForm
        };
        res.setViewData(result);
        this.on('route:BeforeComplete', function (req, res) { // eslint-disable-line no-shadow
            var CustomerMgr = require('dw/customer/CustomerMgr');
            var URLUtils = require('dw/web/URLUtils');
            var Site = require('dw/system/Site');
            var emailHelpers = require('*/cartridge/scripts/helpers/emailHelpers');

            var formInfo = res.getViewData();
            var status;
            var resettingCustomer;
            Transaction.wrap(function () {
                resettingCustomer = CustomerMgr.getCustomerByToken(formInfo.token);
                status = resettingCustomer.profile.credentials.setPasswordWithToken(
                    formInfo.token,
                    formInfo.newPassword
                );
            });
            if (status.error) {
                passwordForm.newpassword.valid = false;
                passwordForm.newpasswordconfirm.valid = false;
                passwordForm.newpasswordconfirm.error =
                    Resource.msg('error.message.resetpassword.invalidformentry', 'forms', null);
                res.render('account/password/newPassword', {
                    passwordForm: passwordForm,
                    token: token
                });
            } else {
                var email = resettingCustomer.profile.email;
                var url = URLUtils.https('Login-Show');
                var objectForEmail = {
                    firstName: resettingCustomer.profile.firstName,
                    lastName: resettingCustomer.profile.lastName,
                    url: url
                };

                var emailObj = {
                    to: email,
                    subject: Resource.msg('subject.profile.resetpassword.email', 'login', null),
                    from: Site.current.getCustomPreferenceValue('customerServiceEmail') || 'no-reply@testorganization.com',
                    type: emailHelpers.emailTypes.passwordReset
                };

                emailHelpers.sendEmail(emailObj, 'account/password/passwordChangedEmail', objectForEmail);
                res.redirect(URLUtils.url('Login-Show'));
            }
        });
    } else {
        res.render('account/password/newPassword', { passwordForm: passwordForm, token: token });
    }
    next();
});

/**
 * Account-Header : The Account-Header endpoint is used as a remote include to include the login/account menu in the header
 * @name Base/Account-Header
 * @function
 * @memberof Account
 * @param {middleware} - server.middleware.include
 * @param {querystringparameter} - mobile - a flag determining whether or not the shopper is on a mobile sized screen this determines what isml template to render
 * @param {category} - sensitive
 * @param {renders} - isml
 * @param {serverfunction} - get
 */
server.get('Header', server.middleware.include, function (req, res, next) {
    var template = req.querystring.mobile ? 'account/mobileHeader' : 'account/header';
    res.render(template, { name:
        req.currentCustomer.profile ? req.currentCustomer.profile.firstName : null
    });
    next();
});

module.exports = server.exports();
</code></pre>
        </article>
    </section>




</div>

<nav id="navigation" class="navigation">
    <div class="search"><input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations"></div>
    <h2><a href="../../index.html">Home</a></h2><h3>Modules</h3><ul><li class="item" data-name="module:calculate"><span class="expand">+</span><a href="module-calculate.html">calculate</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="module:calculate~calculate

calculate is the arching logic for computing the value of a basket.  It makes
calls into cart/calculate.js and enables both SG and OCAPI applications to share
the same cart calculation logic."><a href="module-calculate.html#~calculatecalculateisthearchinglogicforcomputingthevalueofabasket.Itmakescallsintocart/calculate.jsandenablesbothSGandOCAPIapplicationstosharethesamecartcalculationlogic.">calculate

calculate is the arching logic for computing the value of a basket.  It makes
calls into cart/calculate.js and enables both SG and OCAPI applications to share
the same cart calculation logic.</a></li><li data-name="module:calculate~calculateGiftCertificates

Function sets either the net or gross price attribute of all gift certificate
line items of the basket by using the gift certificate base price. It updates the basket in place."><a href="module-calculate.html#~calculateGiftCertificatesFunctionsetseitherthenetorgrosspriceattributeofallgiftcertificatelineitemsofthebasketbyusingthegiftcertificatebaseprice.Itupdatesthebasketinplace.">calculateGiftCertificates

Function sets either the net or gross price attribute of all gift certificate
line items of the basket by using the gift certificate base price. It updates the basket in place.</a></li><li data-name="module:calculate~calculateProductPrices

Calculates product prices based on line item quantities. Set calculates prices
on the product line items.  This updates the basket and returns nothing"><a href="module-calculate.html#~calculateProductPricesCalculatesproductpricesbasedonlineitemquantities.Setcalculatespricesontheproductlineitems.Thisupdatesthebasketandreturnsnothing">calculateProductPrices

Calculates product prices based on line item quantities. Set calculates prices
on the product line items.  This updates the basket and returns nothing</a></li><li data-name="module:calculate~calculateTax <p>

Determines tax rates for all line items of the basket. Uses the shipping addresses
associated with the basket shipments to determine the appropriate tax jurisdiction.
Uses the tax class assigned to products and shipping methods to lookup tax rates. <p>

Sets the tax-related fields of the line items. <p>

Handles gift certificates, which aren't taxable. <p>

Note that the function implements a fallback to the default tax jurisdiction
if no other jurisdiction matches the specified shipping location/shipping address.<p>

Note that the function implements a fallback to the default tax class if a
product or a shipping method does explicitly define a tax class."><a href="module-calculate.html#~calculateTax%253Cp%253EDeterminestaxratesforalllineitemsofthebasket.Usestheshippingaddressesassociatedwiththebasketshipmentstodeterminetheappropriatetaxjurisdiction.Usesthetaxclassassignedtoproductsandshippingmethodstolookuptaxrates.%253Cp%253ESetsthetax-relatedfieldsofthelineitems.%253Cp%253EHandlesgiftcertificates,whicharen'ttaxable.%253Cp%253ENotethatthefunctionimplementsafallbacktothedefaulttaxjurisdictionifnootherjurisdictionmatchesthespecifiedshippinglocation/shippingaddress.%253Cp%253ENotethatthefunctionimplementsafallbacktothedefaulttaxclassifaproductorashippingmethoddoesexplicitlydefineataxclass.">calculateTax <p>

Determines tax rates for all line items of the basket. Uses the shipping addresses
associated with the basket shipments to determine the appropriate tax jurisdiction.
Uses the tax class assigned to products and shipping methods to lookup tax rates. <p>

Sets the tax-related fields of the line items. <p>

Handles gift certificates, which aren't taxable. <p>

Note that the function implements a fallback to the default tax jurisdiction
if no other jurisdiction matches the specified shipping location/shipping address.<p>

Note that the function implements a fallback to the default tax class if a
product or a shipping method does explicitly define a tax class.</a></li></ul></li></ul><h3>Classes</h3><ul><li class="item" data-name="account"><span class="expand">&nbsp;</span><a href="account_.html">account</a></li><li class="item" data-name="address"><span class="expand">&nbsp;</span><a href="address_.html">address</a></li><li class="item" data-name="billing"><span class="expand">&nbsp;</span><a href="billing.html">billing</a></li><li class="item" data-name="BooleanAttributeValue"><span class="expand">&nbsp;</span><a href="BooleanAttributeValue.html">BooleanAttributeValue</a></li><li class="item" data-name="BooleanRefinementValueWrapper"><span class="expand">&nbsp;</span><a href="BooleanRefinementValueWrapper.html">BooleanRefinementValueWrapper</a></li><li class="item" data-name="CartModel"><span class="expand">&nbsp;</span><a href="CartModel.html">CartModel</a></li><li class="item" data-name="categories"><span class="expand">&nbsp;</span><a href="categories.html">categories</a></li><li class="item" data-name="CategoryAttributeValue"><span class="expand">&nbsp;</span><a href="CategoryAttributeValue.html">CategoryAttributeValue</a></li><li class="item" data-name="CategoryRefinementValueWrapper"><span class="expand">&nbsp;</span><a href="CategoryRefinementValueWrapper.html">CategoryRefinementValueWrapper</a></li><li class="item" data-name="CategorySuggestions"><span class="expand">&nbsp;</span><a href="CategorySuggestions.html">CategorySuggestions</a></li><li class="item" data-name="ColorAttributeValue"><span class="expand">&nbsp;</span><a href="ColorAttributeValue.html">ColorAttributeValue</a></li><li class="item" data-name="ColorRefinementValueWrapper"><span class="expand">&nbsp;</span><a href="ColorRefinementValueWrapper.html">ColorRefinementValueWrapper</a></li><li class="item" data-name="content"><span class="expand">&nbsp;</span><a href="content.html">content</a></li><li class="item" data-name="ContentSearch"><span class="expand">&nbsp;</span><a href="ContentSearch.html">ContentSearch</a></li><li class="item" data-name="ContentSuggestions"><span class="expand">&nbsp;</span><a href="ContentSuggestions.html">ContentSuggestions</a></li><li class="item" data-name="DefaultPrice"><span class="expand">&nbsp;</span><a href="DefaultPrice.html">DefaultPrice</a></li><li class="item" data-name="EventEmitter"><span class="expand">+</span><a href="EventEmitter.html">EventEmitter</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="EventEmitter#emit"><a href="EventEmitter.html#emit">emit</a></li><li data-name="EventEmitter#listeners"><a href="EventEmitter.html#listeners">listeners</a></li><li data-name="EventEmitter#on"><a href="EventEmitter.html#on">on</a></li><li data-name="EventEmitter#once"><a href="EventEmitter.html#once">once</a></li><li data-name="EventEmitter#removeAllListeners"><a href="EventEmitter.html#removeAllListeners">removeAllListeners</a></li><li data-name="EventEmitter#removeListener"><a href="EventEmitter.html#removeListener">removeListener</a></li></ul></li><li class="item" data-name="Images"><span class="expand">&nbsp;</span><a href="Images.html">Images</a></li><li class="item" data-name="Locale"><span class="expand">&nbsp;</span><a href="Locale.html">Locale</a></li><li class="item" data-name="OrderModel"><span class="expand">&nbsp;</span><a href="OrderModel.html">OrderModel</a></li><li class="item" data-name="Payment"><span class="expand">&nbsp;</span><a href="Payment.html">Payment</a></li><li class="item" data-name="PriceAttributeValue"><span class="expand">+</span><a href="PriceAttributeValue.html">PriceAttributeValue</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="PriceAttributeValue#getUrl"><a href="PriceAttributeValue.html#getUrl">getUrl</a></li><li data-name="PriceAttributeValue#isSelected"><a href="PriceAttributeValue.html#isSelected">isSelected</a></li></ul></li><li class="item" data-name="PriceRefinementValueWrapper"><span class="expand">&nbsp;</span><a href="PriceRefinementValueWrapper.html">PriceRefinementValueWrapper</a></li><li class="item" data-name="ProductLineItems"><span class="expand">&nbsp;</span><a href="ProductLineItems.html">ProductLineItems</a></li><li class="item" data-name="ProductSearch"><span class="expand">&nbsp;</span><a href="ProductSearch.html">ProductSearch</a></li><li class="item" data-name="ProductSortOptions"><span class="expand">&nbsp;</span><a href="ProductSortOptions.html">ProductSortOptions</a></li><li class="item" data-name="ProductSuggestions"><span class="expand">&nbsp;</span><a href="ProductSuggestions.html">ProductSuggestions</a></li><li class="item" data-name="PromotionAttributeValue"><span class="expand">&nbsp;</span><a href="PromotionAttributeValue.html">PromotionAttributeValue</a></li><li class="item" data-name="PromotionRefinementValueWrapper"><span class="expand">&nbsp;</span><a href="PromotionRefinementValueWrapper.html">PromotionRefinementValueWrapper</a></li><li class="item" data-name="RangePrice"><span class="expand">&nbsp;</span><a href="RangePrice.html">RangePrice</a></li><li class="item" data-name="Request"><span class="expand">&nbsp;</span><a href="Request.html">Request</a></li><li class="item" data-name="Response"><span class="expand">+</span><a href="global.html#Response">Response</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Response#cacheExpiration"><a href="global.html#Response#cacheExpiration">cacheExpiration</a></li><li data-name="Response#getViewData"><a href="global.html#Response#getViewData">getViewData</a></li><li data-name="Response#json"><a href="global.html#Response#json">json</a></li><li data-name="Response#log"><a href="global.html#Response#log">log</a></li><li data-name="Response#page"><a href="global.html#Response#page">page</a></li><li data-name="Response#print"><a href="global.html#Response#print">print</a></li><li data-name="Response#redirect"><a href="global.html#Response#redirect">redirect</a></li><li data-name="Response#render"><a href="global.html#Response#render">render</a></li><li data-name="Response#setContentType"><a href="global.html#Response#setContentType">setContentType</a></li><li data-name="Response#setHttpHeader"><a href="global.html#Response#setHttpHeader">setHttpHeader</a></li><li data-name="Response#setRedirectStatus"><a href="global.html#Response#setRedirectStatus">setRedirectStatus</a></li><li data-name="Response#setStatusCode"><a href="global.html#Response#setStatusCode">setStatusCode</a></li><li data-name="Response#setViewData"><a href="global.html#Response#setViewData">setViewData</a></li><li data-name="Response#xml"><a href="global.html#Response#xml">xml</a></li></ul></li><li class="item" data-name="Route"><span class="expand">+</span><a href="Route.html">Route</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Route#append"><a href="Route.html#append">append</a></li><li data-name="Route#done"><a href="Route.html#done">done</a></li><li data-name="Route#getRoute"><a href="Route.html#getRoute">getRoute</a></li></ul></li><li class="item" data-name="SearchPhraseSuggestions"><span class="expand">&nbsp;</span><a href="SearchPhraseSuggestions.html">SearchPhraseSuggestions</a></li><li class="item" data-name="Server"><span class="expand">+</span><a href="Server.html">Server</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Server#append"><a href="Server.html#append">append</a></li><li data-name="Server#extend"><a href="Server.html#extend">extend</a></li><li data-name="Server#get"><a href="Server.html#get">get</a></li><li data-name="Server#getRoute"><a href="Server.html#getRoute">getRoute</a></li><li data-name="Server#post"><a href="Server.html#post">post</a></li><li data-name="Server#prepend"><a href="Server.html#prepend">prepend</a></li><li data-name="Server#replace"><a href="Server.html#replace">replace</a></li><li data-name="Server#use"><a href="Server.html#use">use</a></li></ul></li><li class="item" data-name="ShippingModel"><span class="expand">&nbsp;</span><a href="ShippingModel.html">ShippingModel</a></li><li class="item" data-name="SizeAttributeValue"><span class="expand">&nbsp;</span><a href="SizeAttributeValue.html">SizeAttributeValue</a></li><li class="item" data-name="SizeRefinementValueWrapper"><span class="expand">&nbsp;</span><a href="SizeRefinementValueWrapper.html">SizeRefinementValueWrapper</a></li><li class="item" data-name="store"><span class="expand">&nbsp;</span><a href="store.html">store</a></li><li class="item" data-name="stores"><span class="expand">&nbsp;</span><a href="stores_.html">stores</a></li><li class="item" data-name="TieredPrice"><span class="expand">&nbsp;</span><a href="TieredPrice.html">TieredPrice</a></li><li class="item" data-name="totals"><span class="expand">&nbsp;</span><a href="totals.html">totals</a></li><li class="item" data-name="VariationAttributesModel"><span class="expand">&nbsp;</span><a href="VariationAttributesModel.html">VariationAttributesModel</a></li></ul><h3>Namespaces</h3><ul><li class="item" data-name="Account"><span class="expand">+</span><a href="Account.html">Account</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Account.Base/Account-EditPassword"><a href="Account.html#.Base/Account-EditPassword">Base/Account-EditPassword</a></li><li data-name="Account.Base/Account-EditProfile"><a href="Account.html#.Base/Account-EditProfile">Base/Account-EditProfile</a></li><li data-name="Account.Base/Account-Header"><a href="Account.html#.Base/Account-Header">Base/Account-Header</a></li><li data-name="Account.Base/Account-Login"><a href="Account.html#.Base/Account-Login">Base/Account-Login</a></li><li data-name="Account.Base/Account-PasswordReset"><a href="Account.html#.Base/Account-PasswordReset">Base/Account-PasswordReset</a></li><li data-name="Account.Base/Account-PasswordResetDialogForm"><a href="Account.html#.Base/Account-PasswordResetDialogForm">Base/Account-PasswordResetDialogForm</a></li><li data-name="Account.Base/Account-SaveNewPassword"><a href="Account.html#.Base/Account-SaveNewPassword">Base/Account-SaveNewPassword</a></li><li data-name="Account.Base/Account-SavePassword"><a href="Account.html#.Base/Account-SavePassword">Base/Account-SavePassword</a></li><li data-name="Account.Base/Account-SaveProfile"><a href="Account.html#.Base/Account-SaveProfile">Base/Account-SaveProfile</a></li><li data-name="Account.Base/Account-SetNewPassword"><a href="Account.html#.Base/Account-SetNewPassword">Base/Account-SetNewPassword</a></li><li data-name="Account.Base/Account-Show"><a href="Account.html#.Base/Account-Show">Base/Account-Show</a></li><li data-name="Account.Base/Account-SubmitRegistration"><a href="Account.html#.Base/Account-SubmitRegistration">Base/Account-SubmitRegistration</a></li></ul></li><li class="item" data-name="Address"><span class="expand">+</span><a href="Address.html">Address</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Address.Base/Address-AddAddress"><a href="Address.html#.Base/Address-AddAddress">Base/Address-AddAddress</a></li><li data-name="Address.Base/Address-DeleteAddress"><a href="Address.html#.Base/Address-DeleteAddress">Base/Address-DeleteAddress</a></li><li data-name="Address.Base/Address-EditAddress"><a href="Address.html#.Base/Address-EditAddress">Base/Address-EditAddress</a></li><li data-name="Address.Base/Address-Header"><a href="Address.html#.Base/Address-Header">Base/Address-Header</a></li><li data-name="Address.Base/Address-List"><a href="Address.html#.Base/Address-List">Base/Address-List</a></li><li data-name="Address.Base/Address-SaveAddress"><a href="Address.html#.Base/Address-SaveAddress">Base/Address-SaveAddress</a></li><li data-name="Address.Base/Address-SetDefault"><a href="Address.html#.Base/Address-SetDefault">Base/Address-SetDefault</a></li></ul></li><li class="item" data-name="Cart"><span class="expand">+</span><a href="Cart.html">Cart</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Cart.Base/Cart-AddBonusProducts"><a href="Cart.html#.Base/Cart-AddBonusProducts">Base/Cart-AddBonusProducts</a></li><li data-name="Cart.Base/Cart-AddCoupon"><a href="Cart.html#.Base/Cart-AddCoupon">Base/Cart-AddCoupon</a></li><li data-name="Cart.Base/Cart-AddProduct"><a href="Cart.html#.Base/Cart-AddProduct">Base/Cart-AddProduct</a></li><li data-name="Cart.Base/Cart-EditBonusProduct"><a href="Cart.html#.Base/Cart-EditBonusProduct">Base/Cart-EditBonusProduct</a></li><li data-name="Cart.Base/Cart-EditProductLineItem"><a href="Cart.html#.Base/Cart-EditProductLineItem">Base/Cart-EditProductLineItem</a></li><li data-name="Cart.Base/Cart-Get"><a href="Cart.html#.Base/Cart-Get">Base/Cart-Get</a></li><li data-name="Cart.Base/Cart-GetProduct"><a href="Cart.html#.Base/Cart-GetProduct">Base/Cart-GetProduct</a></li><li data-name="Cart.Base/Cart-MiniCart"><a href="Cart.html#.Base/Cart-MiniCart">Base/Cart-MiniCart</a></li><li data-name="Cart.Base/Cart-MiniCartShow"><a href="Cart.html#.Base/Cart-MiniCartShow">Base/Cart-MiniCartShow</a></li><li data-name="Cart.Base/Cart-RemoveCouponLineItem"><a href="Cart.html#.Base/Cart-RemoveCouponLineItem">Base/Cart-RemoveCouponLineItem</a></li><li data-name="Cart.Base/Cart-RemoveProductLineItem"><a href="Cart.html#.Base/Cart-RemoveProductLineItem">Base/Cart-RemoveProductLineItem</a></li><li data-name="Cart.Base/Cart-SelectShippingMethod"><a href="Cart.html#.Base/Cart-SelectShippingMethod">Base/Cart-SelectShippingMethod</a></li><li data-name="Cart.Base/Cart-Show"><a href="Cart.html#.Base/Cart-Show">Base/Cart-Show</a></li><li data-name="Cart.Base/Cart-UpdateQuantity"><a href="Cart.html#.Base/Cart-UpdateQuantity">Base/Cart-UpdateQuantity</a></li></ul></li><li class="item" data-name="Checkout"><span class="expand">+</span><a href="Checkout.html">Checkout</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Checkout.Base/Checkout-Begin"><a href="Checkout.html#.Base/Checkout-Begin">Base/Checkout-Begin</a></li><li data-name="Checkout.Base/Checkout-Login"><a href="Checkout.html#.Base/Checkout-Login">Base/Checkout-Login</a></li></ul></li><li class="item" data-name="CheckoutAddressServices"><span class="expand">+</span><a href="CheckoutAddressServices.html">CheckoutAddressServices</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="CheckoutAddressServices.Base/CheckoutAddressServices-AddNewAddress"><a href="CheckoutAddressServices.html#.Base/CheckoutAddressServices-AddNewAddress">Base/CheckoutAddressServices-AddNewAddress</a></li><li data-name="CheckoutAddressServices.Base/CheckoutAddressServices-CreateNewAddress"><a href="CheckoutAddressServices.html#.Base/CheckoutAddressServices-CreateNewAddress">Base/CheckoutAddressServices-CreateNewAddress</a></li></ul></li><li class="item" data-name="CheckoutServices"><span class="expand">+</span><a href="CheckoutServices.html">CheckoutServices</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="CheckoutServices.Base/CheckoutServices-Get"><a href="CheckoutServices.html#.Base/CheckoutServices-Get">Base/CheckoutServices-Get</a></li><li data-name="CheckoutServices.Base/CheckoutServices-PlaceOrder"><a href="CheckoutServices.html#.Base/CheckoutServices-PlaceOrder">Base/CheckoutServices-PlaceOrder</a></li><li data-name="CheckoutServices.Base/CheckoutServices-SubmitPayment"><a href="CheckoutServices.html#.Base/CheckoutServices-SubmitPayment">Base/CheckoutServices-SubmitPayment</a></li></ul></li><li class="item" data-name="CheckoutShippingServices"><span class="expand">+</span><a href="CheckoutShippingServices.html">CheckoutShippingServices</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="CheckoutShippingServices.Base/CheckoutShippingServices-SelectShippingMethod"><a href="CheckoutShippingServices.html#.Base/CheckoutShippingServices-SelectShippingMethod">Base/CheckoutShippingServices-SelectShippingMethod</a></li><li data-name="CheckoutShippingServices.Base/CheckoutShippingServices-SubmitShipping"><a href="CheckoutShippingServices.html#.Base/CheckoutShippingServices-SubmitShipping">Base/CheckoutShippingServices-SubmitShipping</a></li><li data-name="CheckoutShippingServices.Base/CheckoutShippingServices-ToggleMultiShip"><a href="CheckoutShippingServices.html#.Base/CheckoutShippingServices-ToggleMultiShip">Base/CheckoutShippingServices-ToggleMultiShip</a></li><li data-name="CheckoutShippingServices.Base/CheckoutShippingServices-UpdateShippingMethodsList"><a href="CheckoutShippingServices.html#.Base/CheckoutShippingServices-UpdateShippingMethodsList">Base/CheckoutShippingServices-UpdateShippingMethodsList</a></li></ul></li><li class="item" data-name="ConsentTracking"><span class="expand">+</span><a href="ConsentTracking.html">ConsentTracking</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="ConsentTracking.Base/ConsentTracking-Check"><a href="ConsentTracking.html#.Base/ConsentTracking-Check">Base/ConsentTracking-Check</a></li><li data-name="ConsentTracking.Base/ConsentTracking-GetContent"><a href="ConsentTracking.html#.Base/ConsentTracking-GetContent">Base/ConsentTracking-GetContent</a></li><li data-name="ConsentTracking.Base/ConsentTracking-SetSession"><a href="ConsentTracking.html#.Base/ConsentTracking-SetSession">Base/ConsentTracking-SetSession</a></li></ul></li><li class="item" data-name="ContactUs"><span class="expand">+</span><a href="ContactUs.html">ContactUs</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="ContactUs.Base/ContactUs-Landing"><a href="ContactUs.html#.Base/ContactUs-Landing">Base/ContactUs-Landing</a></li><li data-name="ContactUs.Base/ContactUs-Subscribe"><a href="ContactUs.html#.Base/ContactUs-Subscribe">Base/ContactUs-Subscribe</a></li></ul></li><li class="item" data-name="CSRF"><span class="expand">+</span><a href="CSRF.html">CSRF</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="CSRF.Base/CSRF-AjaxFail"><a href="CSRF.html#.Base/CSRF-AjaxFail">Base/CSRF-AjaxFail</a></li><li data-name="CSRF.Base/CSRF-Fail"><a href="CSRF.html#.Base/CSRF-Fail">Base/CSRF-Fail</a></li><li data-name="CSRF.Base/CSRF-Generate"><a href="CSRF.html#.Base/CSRF-Generate">Base/CSRF-Generate</a></li></ul></li><li class="item" data-name="Default"><span class="expand">+</span><a href="Default.html">Default</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Default.Base/Default-Start"><a href="Default.html#.Base/Default-Start">Base/Default-Start</a></li></ul></li><li class="item" data-name="EinsteinCarousel"><span class="expand">+</span><a href="EinsteinCarousel.html">EinsteinCarousel</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="EinsteinCarousel.Base/EinsteinCarousel-Load"><a href="EinsteinCarousel.html#.Base/EinsteinCarousel-Load">Base/EinsteinCarousel-Load</a></li></ul></li><li class="item" data-name="EmailSubscribe"><span class="expand">+</span><a href="EmailSubscribe.html">EmailSubscribe</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="EmailSubscribe.Base/EmailSubscribe-Subscribe"><a href="EmailSubscribe.html#.Base/EmailSubscribe-Subscribe">Base/EmailSubscribe-Subscribe</a></li></ul></li><li class="item" data-name="Error"><span class="expand">+</span><a href="Error.html">Error</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Error.Base/Error-ErrorCode"><a href="Error.html#.Base/Error-ErrorCode">Base/Error-ErrorCode</a></li><li data-name="Error.Base/Error-Forbidden"><a href="Error.html#.Base/Error-Forbidden">Base/Error-Forbidden</a></li><li data-name="Error.Base/Error-Start"><a href="Error.html#.Base/Error-Start">Base/Error-Start</a></li></ul></li><li class="item" data-name="Home"><span class="expand">+</span><a href="Home.html">Home</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Home.Base/Home-Show"><a href="Home.html#.Base/Home-Show">Base/Home-Show</a></li></ul></li><li class="item" data-name="Link"><span class="expand">+</span><a href="Link.html">Link</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Link.Base/Link-Category"><a href="Link.html#.Base/Link-Category">Base/Link-Category</a></li><li data-name="Link.Base/Link-CategoryProduct"><a href="Link.html#.Base/Link-CategoryProduct">Base/Link-CategoryProduct</a></li><li data-name="Link.Base/Link-Page"><a href="Link.html#.Base/Link-Page">Base/Link-Page</a></li><li data-name="Link.Base/Link-Product"><a href="Link.html#.Base/Link-Product">Base/Link-Product</a></li></ul></li><li class="item" data-name="Login"><span class="expand">+</span><a href="Login.html">Login</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Login.Base/Login-Logout"><a href="Login.html#.Base/Login-Logout">Base/Login-Logout</a></li><li data-name="Login.Base/Login-OAuthLogin"><a href="Login.html#.Base/Login-OAuthLogin">Base/Login-OAuthLogin</a></li><li data-name="Login.Base/Login-OAuthReentry"><a href="Login.html#.Base/Login-OAuthReentry">Base/Login-OAuthReentry</a></li><li data-name="Login.Base/Login-Show"><a href="Login.html#.Base/Login-Show">Base/Login-Show</a></li></ul></li><li class="item" data-name="Order"><span class="expand">+</span><a href="Order.html">Order</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Order.Base/Order-Confirm"><a href="Order.html#.Base/Order-Confirm">Base/Order-Confirm</a></li><li data-name="Order.Base/Order-CreateAccount"><a href="Order.html#.Base/Order-CreateAccount">Base/Order-CreateAccount</a></li><li data-name="Order.Base/Order-Details"><a href="Order.html#.Base/Order-Details">Base/Order-Details</a></li><li data-name="Order.Base/Order-Filtered"><a href="Order.html#.Base/Order-Filtered">Base/Order-Filtered</a></li><li data-name="Order.Base/Order-History"><a href="Order.html#.Base/Order-History">Base/Order-History</a></li><li data-name="Order.Base/Order-Track"><a href="Order.html#.Base/Order-Track">Base/Order-Track</a></li></ul></li><li class="item" data-name="Page"><span class="expand">+</span><a href="Page.html">Page</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Page.Base/Page-Include"><a href="Page.html#.Base/Page-Include">Base/Page-Include</a></li><li data-name="Page.Base/Page-IncludeHeaderMenu"><a href="Page.html#.Base/Page-IncludeHeaderMenu">Base/Page-IncludeHeaderMenu</a></li><li data-name="Page.Base/Page-Locale"><a href="Page.html#.Base/Page-Locale">Base/Page-Locale</a></li><li data-name="Page.Base/Page-SetLocale"><a href="Page.html#.Base/Page-SetLocale">Base/Page-SetLocale</a></li><li data-name="Page.Base/Page-Show"><a href="Page.html#.Base/Page-Show">Base/Page-Show</a></li></ul></li><li class="item" data-name="PaymentInstruments"><span class="expand">+</span><a href="PaymentInstruments.html">PaymentInstruments</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="PaymentInstruments.Base/PaymentInstruments-AddPayment"><a href="PaymentInstruments.html#.Base/PaymentInstruments-AddPayment">Base/PaymentInstruments-AddPayment</a></li><li data-name="PaymentInstruments.Base/PaymentInstruments-DeletePayment"><a href="PaymentInstruments.html#.Base/PaymentInstruments-DeletePayment">Base/PaymentInstruments-DeletePayment</a></li><li data-name="PaymentInstruments.Base/PaymentInstruments-Header"><a href="PaymentInstruments.html#.Base/PaymentInstruments-Header">Base/PaymentInstruments-Header</a></li><li data-name="PaymentInstruments.Base/PaymentInstruments-List"><a href="PaymentInstruments.html#.Base/PaymentInstruments-List">Base/PaymentInstruments-List</a></li><li data-name="PaymentInstruments.Base/PaymentInstruments-SavePayment"><a href="PaymentInstruments.html#.Base/PaymentInstruments-SavePayment">Base/PaymentInstruments-SavePayment</a></li></ul></li><li class="item" data-name="Product"><span class="expand">+</span><a href="Product.html">Product</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Product.Base/Product-Show"><a href="Product.html#.Base/Product-Show">Base/Product-Show</a></li><li data-name="Product.Base/Product-ShowBonusProducts"><a href="Product.html#.Base/Product-ShowBonusProducts">Base/Product-ShowBonusProducts</a></li><li data-name="Product.Base/Product-ShowInCategory"><a href="Product.html#.Base/Product-ShowInCategory">Base/Product-ShowInCategory</a></li><li data-name="Product.Base/Product-ShowQuickView"><a href="Product.html#.Base/Product-ShowQuickView">Base/Product-ShowQuickView</a></li><li data-name="Product.Base/Product-SizeChart"><a href="Product.html#.Base/Product-SizeChart">Base/Product-SizeChart</a></li><li data-name="Product.Base/Product-Variation"><a href="Product.html#.Base/Product-Variation">Base/Product-Variation</a></li></ul></li><li class="item" data-name="RedirectURL"><span class="expand">+</span><a href="RedirectURL.html">RedirectURL</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="RedirectURL.Base/RedirectURL-Hostname"><a href="RedirectURL.html#.Base/RedirectURL-Hostname">Base/RedirectURL-Hostname</a></li><li data-name="RedirectURL.Base/RedirectURL-Start"><a href="RedirectURL.html#.Base/RedirectURL-Start">Base/RedirectURL-Start</a></li></ul></li><li class="item" data-name="ReportingEvent"><span class="expand">+</span><a href="ReportingEvent.html">ReportingEvent</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="ReportingEvent.Base/ReportingEvent-MiniCart"><a href="ReportingEvent.html#.Base/ReportingEvent-MiniCart">Base/ReportingEvent-MiniCart</a></li><li data-name="ReportingEvent.Base/ReportingEvent-Start"><a href="ReportingEvent.html#.Base/ReportingEvent-Start">Base/ReportingEvent-Start</a></li></ul></li><li class="item" data-name="Search"><span class="expand">+</span><a href="Search.html">Search</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Search.Base/Search-Content"><a href="Search.html#.Base/Search-Content">Base/Search-Content</a></li><li data-name="Search.Base/Search-Refinebar"><a href="Search.html#.Base/Search-Refinebar">Base/Search-Refinebar</a></li><li data-name="Search.Base/Search-Show"><a href="Search.html#.Base/Search-Show">Base/Search-Show</a></li><li data-name="Search.Base/Search-ShowAjax"><a href="Search.html#.Base/Search-ShowAjax">Base/Search-ShowAjax</a></li><li data-name="Search.Base/Search-UpdateGrid"><a href="Search.html#.Base/Search-UpdateGrid">Base/Search-UpdateGrid</a></li></ul></li><li class="item" data-name="SearchServices"><span class="expand">+</span><a href="SearchServices.html">SearchServices</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="SearchServices.Base/SearchServices-GetSuggestions"><a href="SearchServices.html#.Base/SearchServices-GetSuggestions">Base/SearchServices-GetSuggestions</a></li></ul></li><li class="item" data-name="SourceCodeRedirect"><span class="expand">+</span><a href="SourceCodeRedirect.html">SourceCodeRedirect</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="SourceCodeRedirect.Base/SourceCodeRedirect-Start"><a href="SourceCodeRedirect.html#.Base/SourceCodeRedirect-Start">Base/SourceCodeRedirect-Start</a></li></ul></li><li class="item" data-name="Stores"><span class="expand">+</span><a href="Stores.html">Stores</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Stores.Base/Stores-Find"><a href="Stores.html#.Base/Stores-Find">Base/Stores-Find</a></li><li data-name="Stores.Base/Stores-FindStores"><a href="Stores.html#.Base/Stores-FindStores">Base/Stores-FindStores</a></li></ul></li><li class="item" data-name="Tile"><span class="expand">+</span><a href="Tile.html">Tile</a><ul class="methods itemMembers"><span class="subtitle">Methods</span><li data-name="Tile.Base/Tile-Show"><a href="Tile.html#.Base/Tile-Show">Base/Tile-Show</a></li></ul></li></ul><h3>Tutorials</h3><ul><li class="item" data-name="Controllers"><span class="expand">&nbsp;</span><a href="tutorial-Controllers.html">Controllers</a></li><li class="item" data-name="Payment"><span class="expand">&nbsp;</span><a href="tutorial-Payment_.html">Payment processing</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addLineItem">addLineItem</a></li><li><a href="global.html#addProductToCart">addProductToCart</a></li><li><a href="global.html#addRefinementValues">addRefinementValues</a></li><li><a href="global.html#addResource">addResource</a></li><li><a href="global.html#allBundleItemsSame">allBundleItemsSame</a></li><li><a href="global.html#appendQueryParams">appendQueryParams</a></li><li><a href="global.html#appendRenderings">appendRenderings</a></li><li><a href="global.html#applicablePaymentCards">applicablePaymentCards</a></li><li><a href="global.html#applicablePaymentMethods">applicablePaymentMethods</a></li><li><a href="global.html#applyCache">applyCache</a></li><li><a href="global.html#applyDefaultCache">applyDefaultCache</a></li><li><a href="global.html#applyInventorySensitiveCache">applyInventorySensitiveCache</a></li><li><a href="global.html#applyPromotionSensitiveCache">applyPromotionSensitiveCache</a></li><li><a href="global.html#applyRenderings">applyRenderings</a></li><li><a href="global.html#applyShortPromotionSensitiveCache">applyShortPromotionSensitiveCache</a></li><li><a href="global.html#Authorize">Authorize</a></li><li><a href="global.html#backButtonDetection">backButtonDetection</a></li><li><a href="global.html#calculatePaymentTransaction">calculatePaymentTransaction</a></li><li><a href="global.html#calculateTaxes">calculateTaxes</a></li><li><a href="global.html#calculateTotals">calculateTotals</a></li><li><a href="global.html#categoryToObject">categoryToObject</a></li><li><a href="global.html#checkBundledProductCanBeAdded">checkBundledProductCanBeAdded</a></li><li><a href="global.html#checkIfAddressStored">checkIfAddressStored</a></li><li><a href="global.html#checkParams">checkParams</a></li><li><a href="global.html#computedPageMetaData">computedPageMetaData</a></li><li><a href="global.html#concat">concat</a></li><li><a href="global.html#consent">consent</a></li><li><a href="global.html#copyBillingAddressToBasket">copyBillingAddressToBasket</a></li><li><a href="global.html#copyCustomerAddressToBilling">copyCustomerAddressToBilling</a></li><li><a href="global.html#copyCustomerAddressToShipment">copyCustomerAddressToShipment</a></li><li><a href="global.html#copyObjectToForm">copyObjectToForm</a></li><li><a href="global.html#copyShippingAddress">copyShippingAddress</a></li><li><a href="global.html#copyShippingAddressToShipment">copyShippingAddressToShipment</a></li><li><a href="global.html#countBonusProducts">countBonusProducts</a></li><li><a href="global.html#createAddressObject">createAddressObject</a></li><li><a href="global.html#createCategorySearchRefinement">createCategorySearchRefinement</a></li><li><a href="global.html#createDiscountObject">createDiscountObject</a></li><li><a href="global.html#createGeoLocationObject">createGeoLocationObject</a></li><li><a href="global.html#createOrder">createOrder</a></li><li><a href="global.html#createProductLineItemsObject">createProductLineItemsObject</a></li><li><a href="global.html#createProductSearchRefinement">createProductSearchRefinement</a></li><li><a href="global.html#createStoresObject">createStoresObject</a></li><li><a href="global.html#createStoresResultsHtml">createStoresResultsHtml</a></li><li><a href="global.html#createToken">createToken</a></li><li><a href="global.html#EE">EE</a></li><li><a href="global.html#emptyAddress">emptyAddress</a></li><li><a href="global.html#ensureAllShipmentsHaveMethods">ensureAllShipmentsHaveMethods</a></li><li><a href="global.html#ensureNoEmptyShipments">ensureNoEmptyShipments</a></li><li><a href="global.html#ensureShipmentHasMethod">ensureShipmentHasMethod</a></li><li><a href="global.html#ensureValidShipments">ensureValidShipments</a></li><li><a href="global.html#every">every</a></li><li><a href="global.html#excludeUuid">excludeUuid</a></li><li><a href="global.html#find">find</a></li><li><a href="global.html#findValue">findValue</a></li><li><a href="global.html#first">first</a></li><li><a href="global.html#forEach">forEach</a></li><li><a href="global.html#formatCurrency">formatCurrency</a></li><li><a href="global.html#formatNumber">formatNumber</a></li><li><a href="global.html#formatPrice">formatPrice</a></li><li><a href="global.html#formField">formField</a></li><li><a href="global.html#fraudDetection">fraudDetection</a></li><li><a href="global.html#gatherShippingAddresses">gatherShippingAddresses</a></li><li><a href="global.html#generateAddressName">generateAddressName</a></li><li><a href="global.html#generateToken">generateToken</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#getAccountModel">getAccountModel</a></li><li><a href="global.html#getAccountOpenReportingURLs">getAccountOpenReportingURLs</a></li><li><a href="global.html#getAddresses">getAddresses</a></li><li><a href="global.html#getAddressFromRequest">getAddressFromRequest</a></li><li><a href="global.html#getAddressObject">getAddressObject</a></li><li><a href="global.html#getAllAttrValues">getAllAttrValues</a></li><li><a href="global.html#getAllBreadcrumbs">getAllBreadcrumbs</a></li><li><a href="global.html#getApplicableShippingMethods">getApplicableShippingMethods</a></li><li><a href="global.html#getAppliedPromotions">getAppliedPromotions</a></li><li><a href="global.html#getApproachingDiscounts">getApproachingDiscounts</a></li><li><a href="global.html#getAssociatedAddress">getAssociatedAddress</a></li><li><a href="global.html#getAttributeRefinementValueModel">getAttributeRefinementValueModel</a></li><li><a href="global.html#getAttributes">getAttributes</a></li><li><a href="global.html#getAttrResetUrl">getAttrResetUrl</a></li><li><a href="global.html#getBannerImageUrl">getBannerImageUrl</a></li><li><a href="global.html#getBasketOpenReportingURLs">getBasketOpenReportingURLs</a></li><li><a href="global.html#getBonusUnitPrice">getBonusUnitPrice</a></li><li><a href="global.html#getBundledProductLineItems">getBundledProductLineItems</a></li><li><a href="global.html#getBundledProducts">getBundledProducts</a></li><li><a href="global.html#getCartActionUrls">getCartActionUrls</a></li><li><a href="global.html#getCategoryTemplate">getCategoryTemplate</a></li><li><a href="global.html#getCategoryUrl">getCategoryUrl</a></li><li><a href="global.html#getCheckoutReportingURLs">getCheckoutReportingURLs</a></li><li><a href="global.html#getCheckoutStepInformation">getCheckoutStepInformation</a></li><li><a href="global.html#getConfig">getConfig</a></li><li><a href="global.html#getContentSearchPageJSON">getContentSearchPageJSON</a></li><li><a href="global.html#getCurrentLocale">getCurrentLocale</a></li><li><a href="global.html#getCurrentOptionModel">getCurrentOptionModel</a></li><li><a href="global.html#getCustomerObject">getCustomerObject</a></li><li><a href="global.html#getCustomerPaymentInstruments">getCustomerPaymentInstruments</a></li><li><a href="global.html#getDefaultOptions">getDefaultOptions</a></li><li><a href="global.html#getDetailsObject">getDetailsObject</a></li><li><a href="global.html#getDiscountLineItems">getDiscountLineItems</a></li><li><a href="global.html#getDiscounts">getDiscounts</a></li><li><a href="global.html#getDiscountsHtml">getDiscountsHtml</a></li><li><a href="global.html#getExistingProductLineItemInCart">getExistingProductLineItemInCart</a></li><li><a href="global.html#getExistingProductLineItemsInCart">getExistingProductLineItemsInCart</a></li><li><a href="global.html#getExpirationYears">getExpirationYears</a></li><li><a href="global.html#getFirstApplicableShippingMethod">getFirstApplicableShippingMethod</a></li><li><a href="global.html#getFirstNonDefaultShipmentWithProductLineItems">getFirstNonDefaultShipmentWithProductLineItems</a></li><li><a href="global.html#getFirstProductLineItem">getFirstProductLineItem</a></li><li><a href="global.html#getFormData">getFormData</a></li><li><a href="global.html#getFormErrors">getFormErrors</a></li><li><a href="global.html#getGeolocationObject">getGeolocationObject</a></li><li><a href="global.html#getGoogleMapsApi">getGoogleMapsApi</a></li><li><a href="global.html#getHtmlContext">getHtmlContext</a></li><li><a href="global.html#getImageUrl">getImageUrl</a></li><li><a href="global.html#getIndividualProducts">getIndividualProducts</a></li><li><a href="global.html#getIsSelected">getIsSelected</a></li><li><a href="global.html#getItemPromoReportingURLs">getItemPromoReportingURLs</a></li><li><a href="global.html#getLastOrder">getLastOrder</a></li><li><a href="global.html#getLineItemOptionNames">getLineItemOptionNames</a></li><li><a href="global.html#getLineItemOptions">getLineItemOptions</a></li><li><a href="global.html#getList">getList</a></li><li><a href="global.html#getListingPageSchema">getListingPageSchema</a></li><li><a href="global.html#getListPrice">getListPrice</a></li><li><a href="global.html#getListPrices">getListPrices</a></li><li><a href="global.html#getLocaleLinks">getLocaleLinks</a></li><li><a href="global.html#getLoginRedirectURL">getLoginRedirectURL</a></li><li><a href="global.html#getMatchingProducts">getMatchingProducts</a></li><li><a href="global.html#getMinMaxQuantityOptions">getMinMaxQuantityOptions</a></li><li><a href="global.html#getNewBonusDiscountLineItem">getNewBonusDiscountLineItem</a></li><li><a href="global.html#getOptions">getOptions</a></li><li><a href="global.html#getOptionValues">getOptionValues</a></li><li><a href="global.html#getOrderDetails">getOrderDetails</a></li><li><a href="global.html#getOrderLevelDiscountTotal">getOrderLevelDiscountTotal</a></li><li><a href="global.html#getOrderPlacedReportingURLs">getOrderPlacedReportingURLs</a></li><li><a href="global.html#getOrderPromoReportingURLs">getOrderPromoReportingURLs</a></li><li><a href="global.html#getOrderReportingURLs">getOrderReportingURLs</a></li><li><a href="global.html#getOrders">getOrders</a></li><li><a href="global.html#getPageDesignerCategoryPage">getPageDesignerCategoryPage</a></li><li><a href="global.html#getPageDesignerProductPage">getPageDesignerProductPage</a></li><li><a href="global.html#getPageMetaData">getPageMetaData</a></li><li><a href="global.html#getPageMetadata">getPageMetadata</a></li><li><a href="global.html#getPagingModel">getPagingModel</a></li><li><a href="global.html#getPasswordResetToken">getPasswordResetToken</a></li><li><a href="global.html#getPayment">getPayment</a></li><li><a href="global.html#getPaymentInstruments">getPaymentInstruments</a></li><li><a href="global.html#getPermalink">getPermalink</a></li><li><a href="global.html#getPhrases">getPhrases</a></li><li><a href="global.html#getPreferredAddress">getPreferredAddress</a></li><li><a href="global.html#getPrice">getPrice</a></li><li><a href="global.html#getProductLineItem">getProductLineItem</a></li><li><a href="global.html#getProductLineItemsModel">getProductLineItemsModel</a></li><li><a href="global.html#getProducts">getProducts</a></li><li><a href="global.html#getProductSchema">getProductSchema</a></li><li><a href="global.html#getProductSearchHit">getProductSearchHit</a></li><li><a href="global.html#getProductSearchReportingURLs">getProductSearchReportingURLs</a></li><li><a href="global.html#getProductType">getProductType</a></li><li><a href="global.html#getProfile">getProfile</a></li><li><a href="global.html#getPromotionPrice">getPromotionPrice</a></li><li><a href="global.html#getPromotions">getPromotions</a></li><li><a href="global.html#getQtyAlreadyInCart">getQtyAlreadyInCart</a></li><li><a href="global.html#getQuantities">getQuantities</a></li><li><a href="global.html#getRefinements">getRefinements</a></li><li><a href="global.html#getRenderedHtml">getRenderedHtml</a></li><li><a href="global.html#getRenderedPaymentInstruments">getRenderedPaymentInstruments</a></li><li><a href="global.html#getRenderedPrice">getRenderedPrice</a></li><li><a href="global.html#getRenderedPromotions">getRenderedPromotions</a></li><li><a href="global.html#getReportingUrlAddToCart">getReportingUrlAddToCart</a></li><li><a href="global.html#getRequestBodyAsString">getRequestBodyAsString</a></li><li><a href="global.html#getResetLink">getResetLink</a></li><li><a href="global.html#getResources">getResources</a></li><li><a href="global.html#getRootPriceBook">getRootPriceBook</a></li><li><a href="global.html#getSelectedFilters">getSelectedFilters</a></li><li><a href="global.html#getSelectedOptionsUrl">getSelectedOptionsUrl</a></li><li><a href="global.html#getSelectedPaymentInstruments">getSelectedPaymentInstruments</a></li><li><a href="global.html#getSelectedShippingMethod">getSelectedShippingMethod</a></li><li><a href="global.html#getSessionObject">getSessionObject</a></li><li><a href="global.html#getSetProductsLength">getSetProductsLength</a></li><li><a href="global.html#getShipmentByUUID">getShipmentByUUID</a></li><li><a href="global.html#getShipmentUUID">getShipmentUUID</a></li><li><a href="global.html#getShippingCost">getShippingCost</a></li><li><a href="global.html#getShippingLevelDiscountTotal">getShippingLevelDiscountTotal</a></li><li><a href="global.html#getShippingModels">getShippingModels</a></li><li><a href="global.html#getShippingPromoReportingURLs">getShippingPromoReportingURLs</a></li><li><a href="global.html#getShowMoreUrl">getShowMoreUrl</a></li><li><a href="global.html#getSortingOptions">getSortingOptions</a></li><li><a href="global.html#getSortRuleDefault">getSortRuleDefault</a></li><li><a href="global.html#getStores">getStores</a></li><li><a href="global.html#getTotalPrice">getTotalPrice</a></li><li><a href="global.html#getTotalQuantity">getTotalQuantity</a></li><li><a href="global.html#getTotals">getTotals</a></li><li><a href="global.html#getUrl">getUrl</a></li><li><a href="global.html#getVariationModel">getVariationModel</a></li><li><a href="global.html#Handle">Handle</a></li><li><a href="global.html#handlePayments">handlePayments</a></li><li><a href="global.html#hasSameOptions">hasSameOptions</a></li><li><a href="global.html#http">http</a></li><li><a href="global.html#https">https</a></li><li><a href="global.html#include">include</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#isLocaleValid">isLocaleValid</a></li><li><a href="global.html#isShippingAddressInitialized">isShippingAddressInitialized</a></li><li><a href="global.html#isSwatchable">isSwatchable</a></li><li><a href="global.html#json">json</a></li><li><a href="global.html#map">map</a></li><li><a href="global.html#normalizeSelectedAttributes">normalizeSelectedAttributes</a></li><li><a href="global.html#page">page</a></li><li><a href="global.html#parameterToArray">parameterToArray</a></li><li><a href="global.html#parseForm">parseForm</a></li><li><a href="global.html#parsePreferences">parsePreferences</a></li><li><a href="global.html#placeOrder">placeOrder</a></li><li><a href="global.html#pluck">pluck</a></li><li><a href="global.html#post">post</a></li><li><a href="global.html#postAuthorization">postAuthorization</a></li><li><a href="global.html#prepareBillingForm">prepareBillingForm</a></li><li><a href="global.html#prepareShippingForm">prepareShippingForm</a></li><li><a href="global.html#processForm">processForm</a></li><li><a href="global.html#recalculateBasket">recalculateBasket</a></li><li><a href="global.html#reduce">reduce</a></li><li><a href="global.html#removeFormValues">removeFormValues</a></li><li><a href="global.html#renderHtml">renderHtml</a></li><li><a href="global.html#renderSkin">renderSkin</a></li><li><a href="global.html#saveAddress">saveAddress</a></li><li><a href="global.html#savePaymentInformation">savePaymentInformation</a></li><li><a href="global.html#savePaymentInstrumentToWallet">savePaymentInstrumentToWallet</a></li><li><a href="global.html#search">search</a></li><li><a href="global.html#selectShippingMethod">selectShippingMethod</a></li><li><a href="global.html#send">send</a></li><li><a href="global.html#sendAccountEditedEmail">sendAccountEditedEmail</a></li><li><a href="global.html#sendConfirmationEmail">sendConfirmationEmail</a></li><li><a href="global.html#sendCreateAccountEmail">sendCreateAccountEmail</a></li><li><a href="global.html#sendPasswordResetEmail">sendPasswordResetEmail</a></li><li><a href="global.html#setCurrency">setCurrency</a></li><li><a href="global.html#setGift">setGift</a></li><li><a href="global.html#setPageMetaData">setPageMetaData</a></li><li><a href="global.html#setPageMetaTags">setPageMetaTags</a></li><li><a href="global.html#setProductProperties">setProductProperties</a></li><li><a href="global.html#setupContentSearch">setupContentSearch</a></li><li><a href="global.html#setupSearch">setupSearch</a></li><li><a href="global.html#ShippingMethodModel">ShippingMethodModel</a></li><li><a href="global.html#showProductPage">showProductPage</a></li><li><a href="global.html#SimpleCache">SimpleCache</a></li><li><a href="global.html#Template">Template</a></li><li><a href="global.html#template">template</a></li><li><a href="global.html#toPriceModel">toPriceModel</a></li><li><a href="global.html#updateAddressFields">updateAddressFields</a></li><li><a href="global.html#updateBundleProducts">updateBundleProducts</a></li><li><a href="global.html#validateAjaxRequest">validateAjaxRequest</a></li><li><a href="global.html#validateBasket">validateBasket</a></li><li><a href="global.html#validateBillingForm">validateBillingForm</a></li><li><a href="global.html#validateCoupons">validateCoupons</a></li><li><a href="global.html#validateCreditCard">validateCreditCard</a></li><li><a href="global.html#validateEmail">validateEmail</a></li><li><a href="global.html#validateFields">validateFields</a></li><li><a href="global.html#validateLoggedIn">validateLoggedIn</a></li><li><a href="global.html#validateLoggedInAjax">validateLoggedInAjax</a></li><li><a href="global.html#validateOrder">validateOrder</a></li><li><a href="global.html#validatePayment">validatePayment</a></li><li><a href="global.html#validateProducts">validateProducts</a></li><li><a href="global.html#validateRequest">validateRequest</a></li><li><a href="global.html#validateShippingForm">validateShippingForm</a></li><li><a href="global.html#verifyCard">verifyCard</a></li><li><a href="global.html#xml">xml</a></li></ul>
</nav>

<br class="clear">

<footer>
    &copy; <span class="year"></span> Salesforce Commerce Cloud<br/>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a>
</footer>

<script src="scripts/jquery.min.js"></script>
<script src="scripts/main.js"></script>
<script>
    prettyPrint();
    document.querySelector('.year').innerHTML = new Date().getFullYear();
</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
